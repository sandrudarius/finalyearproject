{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Home\\\\Desktop\\\\unitest\\\\dappazon\\\\src\\\\components\\\\Product.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { ethers } from 'ethers';\n// Components\nimport Rating from './Rating';\nimport emailjs from \"emailjs-com\";\nimport close from '../assets/close.svg';\nimport { name, address } from './Popup.jsx';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet value;\nconst templateParams = {\n  value: value\n};\nconst Product = _ref => {\n  _s();\n  let {\n    item,\n    provider,\n    account,\n    dappazon,\n    togglePop\n  } = _ref;\n  const [order, setOrder] = useState(null);\n  const [hasBought, setHasBought] = useState(false);\n  const fetchDetails = async () => {\n    const events = await dappazon.queryFilter(\"Buy\");\n    const orders = events.filter(event => event.args.buyer === account && event.args.itemId.toString() === item.id.toString());\n    if (orders.length === 0) return;\n    const order = await dappazon.orders(account, orders[0].args.orderId);\n    setOrder(order);\n  };\n  const buyHandler = async () => {\n    const signer = await provider.getSigner();\n\n    // Buy item...\n    let transaction = await dappazon.connect(signer).buy(item.id, {\n      value: item.cost\n    });\n    await transaction.wait();\n    setHasBought(true);\n    templateParams.value = 'Mr/Mrs ' + name + ' has ordered ' + item.name + 'at the address ' + address + '. Their wallet address is ' + account;\n    console.log(templateParams.value);\n    emailjs.send('service_g95zt4p', 'template_wmos55l', templateParams, 'qEKtcG4ylq3mPPDx9').then(response => {\n      console.log('SUCCESS!', response.status, response.text);\n    }, error => {\n      console.log('FAILED...', error);\n    });\n  };\n  useEffect(() => {\n    fetchDetails();\n  }, [hasBought]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"product\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"product__details\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product__image\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: item.image,\n          alt: \"Product\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product__overview\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: item.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Rating, {\n          value: item.rating\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: item.address\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [ethers.utils.formatUnits(item.cost.toString(), 'ether'), \" ETH\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Overview\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [item.description, \"Lorem ipsum dolor sit amet consectetur adipisicing elit. Minima rem, iusto, consectetur inventore quod soluta quos qui assumenda aperiam, eveniet doloribus commodi error modi eaque! Iure repudiandae temporibus ex? Optio!\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product__order\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: [ethers.utils.formatUnits(item.cost.toString(), 'ether'), \" ETH\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"FREE delivery \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 27\n          }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: new Date(Date.now() + 345600000).toLocaleDateString(undefined, {\n              weekday: 'long',\n              month: 'long',\n              day: 'numeric'\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this), item.stock > 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"In Stock.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Out of Stock.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"product__buy\",\n          onClick: buyHandler,\n          children: \"Buy Now\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"small\", {\n            children: \"Ships from\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 14\n          }, this), \" Rolex\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"small\", {\n            children: \"Sold by\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 14\n          }, this), \" Rolex\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), order && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product__bought\",\n          children: [\"Item bought on \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 30\n          }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: new Date(Number(order.time.toString() + '000')).toLocaleDateString(undefined, {\n              weekday: 'long',\n              hour: 'numeric',\n              minute: 'numeric',\n              second: 'numeric'\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: togglePop,\n        className: \"product__close\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: close,\n          alt: \"Close\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n};\n_s(Product, \"d6wx3FGM19eMk+ho8QwNO8YxwB4=\");\n_c = Product;\nexport default Product;\nvar _c;\n$RefreshReg$(_c, \"Product\");","map":{"version":3,"names":["useEffect","useState","ethers","Rating","emailjs","close","name","address","value","templateParams","Product","item","provider","account","dappazon","togglePop","order","setOrder","hasBought","setHasBought","fetchDetails","events","queryFilter","orders","filter","event","args","buyer","itemId","toString","id","length","orderId","buyHandler","signer","getSigner","transaction","connect","buy","cost","wait","console","log","send","then","response","status","text","error","image","rating","utils","formatUnits","description","Date","now","toLocaleDateString","undefined","weekday","month","day","stock","Number","time","hour","minute","second"],"sources":["C:/Users/Home/Desktop/unitest/dappazon/src/components/Product.js"],"sourcesContent":["import { useEffect, useState } from 'react'\r\nimport { ethers } from 'ethers'\r\n// Components\r\nimport Rating from './Rating'\r\nimport emailjs from \"emailjs-com\";\r\nimport close from '../assets/close.svg'\r\nimport { name, address } from './Popup.jsx';\r\n\r\nlet value\r\n\r\nconst templateParams = {\r\n  value: value,\r\n};\r\n\r\nconst Product = ({ item, provider, account, dappazon, togglePop }) => {\r\n  const [order, setOrder] = useState(null)\r\n  const [hasBought, setHasBought] = useState(false)\r\n\r\n  const fetchDetails = async () => {\r\n    const events = await dappazon.queryFilter(\"Buy\")\r\n    const orders = events.filter(\r\n      (event) => event.args.buyer === account && event.args.itemId.toString() === item.id.toString()\r\n    )\r\n\r\n    if (orders.length === 0) return\r\n\r\n    const order = await dappazon.orders(account, orders[0].args.orderId)\r\n    setOrder(order)\r\n  }\r\n\r\n  const buyHandler = async () => {\r\n    const signer = await provider.getSigner()\r\n\r\n    // Buy item...\r\n    let transaction = await dappazon.connect(signer).buy(item.id, { value: item.cost })\r\n    await transaction.wait()\r\n\r\n    setHasBought(true)\r\n\r\n    templateParams.value = 'Mr/Mrs ' + name + ' has ordered ' + item.name + 'at the address ' + address +'. Their wallet address is ' + account;\r\n    console.log(templateParams.value);\r\n\r\n    emailjs.send('service_g95zt4p', 'template_wmos55l', templateParams, 'qEKtcG4ylq3mPPDx9')\r\n    .then((response) => {\r\n      console.log('SUCCESS!', response.status, response.text);\r\n    }, (error) => {\r\n      console.log('FAILED...', error);\r\n    });\r\n\r\n\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchDetails()\r\n  }, [hasBought])\r\n\r\n  return (\r\n    <div className=\"product\">\r\n      <div className=\"product__details\">\r\n        <div className=\"product__image\">\r\n          <img src={item.image} alt=\"Product\" />\r\n        </div>\r\n        <div className=\"product__overview\">\r\n          <h1>{item.name}</h1>\r\n\r\n          <Rating value={item.rating} />\r\n\r\n          <hr />\r\n\r\n          <p>{item.address}</p>\r\n\r\n          <h2>{ethers.utils.formatUnits(item.cost.toString(), 'ether')} ETH</h2>\r\n\r\n          <hr />\r\n\r\n          <h2>Overview</h2>\r\n\r\n          <p>\r\n            {item.description}\r\n\r\n            Lorem ipsum dolor sit amet consectetur adipisicing elit. Minima rem, iusto,\r\n            consectetur inventore quod soluta quos qui assumenda aperiam, eveniet doloribus\r\n            commodi error modi eaque! Iure repudiandae temporibus ex? Optio!\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"product__order\">\r\n          <h1>{ethers.utils.formatUnits(item.cost.toString(), 'ether')} ETH</h1>\r\n\r\n          <p>\r\n            FREE delivery <br />\r\n            <strong>\r\n              {new Date(Date.now() + 345600000).toLocaleDateString(undefined, { weekday: 'long', month: 'long', day: 'numeric' })}\r\n            </strong>\r\n          </p>\r\n\r\n          {item.stock > 0 ? (\r\n            <p>In Stock.</p>\r\n          ) : (\r\n            <p>Out of Stock.</p>\r\n          )}\r\n\r\n          <button className='product__buy' onClick={buyHandler}>\r\n            Buy Now\r\n          </button>\r\n\r\n          <p><small>Ships from</small> Rolex</p>\r\n          <p><small>Sold by</small> Rolex</p>\r\n\r\n          {order && (\r\n            <div className='product__bought'>\r\n              Item bought on <br />\r\n              <strong>\r\n                {new Date(Number(order.time.toString() + '000')).toLocaleDateString(\r\n                  undefined,\r\n                  {\r\n                    weekday: 'long',\r\n                    hour: 'numeric',\r\n                    minute: 'numeric',\r\n                    second: 'numeric'\r\n                  })}\r\n              </strong>\r\n              \r\n                  \r\n\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n\r\n        <button onClick={togglePop} className=\"product__close\">\r\n          <img src={close} alt=\"Close\" />\r\n        </button>\r\n      </div>\r\n    </div >\r\n  );\r\n}\r\n\r\nexport default Product;"],"mappings":";;AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,MAAM,QAAQ,QAAQ;AAC/B;AACA,OAAOC,MAAM,MAAM,UAAU;AAC7B,OAAOC,OAAO,MAAM,aAAa;AACjC,OAAOC,KAAK,MAAM,qBAAqB;AACvC,SAASC,IAAI,EAAEC,OAAO,QAAQ,aAAa;AAAC;AAE5C,IAAIC,KAAK;AAET,MAAMC,cAAc,GAAG;EACrBD,KAAK,EAAEA;AACT,CAAC;AAED,MAAME,OAAO,GAAG,QAAsD;EAAA;EAAA,IAArD;IAAEC,IAAI;IAAEC,QAAQ;IAAEC,OAAO;IAAEC,QAAQ;IAAEC;EAAU,CAAC;EAC/D,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACiB,SAAS,EAAEC,YAAY,CAAC,GAAGlB,QAAQ,CAAC,KAAK,CAAC;EAEjD,MAAMmB,YAAY,GAAG,YAAY;IAC/B,MAAMC,MAAM,GAAG,MAAMP,QAAQ,CAACQ,WAAW,CAAC,KAAK,CAAC;IAChD,MAAMC,MAAM,GAAGF,MAAM,CAACG,MAAM,CACzBC,KAAK,IAAKA,KAAK,CAACC,IAAI,CAACC,KAAK,KAAKd,OAAO,IAAIY,KAAK,CAACC,IAAI,CAACE,MAAM,CAACC,QAAQ,EAAE,KAAKlB,IAAI,CAACmB,EAAE,CAACD,QAAQ,EAAE,CAC/F;IAED,IAAIN,MAAM,CAACQ,MAAM,KAAK,CAAC,EAAE;IAEzB,MAAMf,KAAK,GAAG,MAAMF,QAAQ,CAACS,MAAM,CAACV,OAAO,EAAEU,MAAM,CAAC,CAAC,CAAC,CAACG,IAAI,CAACM,OAAO,CAAC;IACpEf,QAAQ,CAACD,KAAK,CAAC;EACjB,CAAC;EAED,MAAMiB,UAAU,GAAG,YAAY;IAC7B,MAAMC,MAAM,GAAG,MAAMtB,QAAQ,CAACuB,SAAS,EAAE;;IAEzC;IACA,IAAIC,WAAW,GAAG,MAAMtB,QAAQ,CAACuB,OAAO,CAACH,MAAM,CAAC,CAACI,GAAG,CAAC3B,IAAI,CAACmB,EAAE,EAAE;MAAEtB,KAAK,EAAEG,IAAI,CAAC4B;IAAK,CAAC,CAAC;IACnF,MAAMH,WAAW,CAACI,IAAI,EAAE;IAExBrB,YAAY,CAAC,IAAI,CAAC;IAElBV,cAAc,CAACD,KAAK,GAAG,SAAS,GAAGF,IAAI,GAAG,eAAe,GAAGK,IAAI,CAACL,IAAI,GAAG,iBAAiB,GAAGC,OAAO,GAAE,4BAA4B,GAAGM,OAAO;IAC3I4B,OAAO,CAACC,GAAG,CAACjC,cAAc,CAACD,KAAK,CAAC;IAEjCJ,OAAO,CAACuC,IAAI,CAAC,iBAAiB,EAAE,kBAAkB,EAAElC,cAAc,EAAE,mBAAmB,CAAC,CACvFmC,IAAI,CAAEC,QAAQ,IAAK;MAClBJ,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEG,QAAQ,CAACC,MAAM,EAAED,QAAQ,CAACE,IAAI,CAAC;IACzD,CAAC,EAAGC,KAAK,IAAK;MACZP,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEM,KAAK,CAAC;IACjC,CAAC,CAAC;EAGJ,CAAC;EAEDhD,SAAS,CAAC,MAAM;IACdoB,YAAY,EAAE;EAChB,CAAC,EAAE,CAACF,SAAS,CAAC,CAAC;EAEf,oBACE;IAAK,SAAS,EAAC,SAAS;IAAA,uBACtB;MAAK,SAAS,EAAC,kBAAkB;MAAA,wBAC/B;QAAK,SAAS,EAAC,gBAAgB;QAAA,uBAC7B;UAAK,GAAG,EAAEP,IAAI,CAACsC,KAAM;UAAC,GAAG,EAAC;QAAS;UAAA;UAAA;UAAA;QAAA;MAAG;QAAA;QAAA;QAAA;MAAA,QAClC,eACN;QAAK,SAAS,EAAC,mBAAmB;QAAA,wBAChC;UAAA,UAAKtC,IAAI,CAACL;QAAI;UAAA;UAAA;UAAA;QAAA,QAAM,eAEpB,QAAC,MAAM;UAAC,KAAK,EAAEK,IAAI,CAACuC;QAAO;UAAA;UAAA;UAAA;QAAA,QAAG,eAE9B;UAAA;UAAA;UAAA;QAAA,QAAM,eAEN;UAAA,UAAIvC,IAAI,CAACJ;QAAO;UAAA;UAAA;UAAA;QAAA,QAAK,eAErB;UAAA,WAAKL,MAAM,CAACiD,KAAK,CAACC,WAAW,CAACzC,IAAI,CAAC4B,IAAI,CAACV,QAAQ,EAAE,EAAE,OAAO,CAAC;QAAA;UAAA;UAAA;UAAA;QAAA,QAAU,eAEtE;UAAA;UAAA;UAAA;QAAA,QAAM,eAEN;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAAiB,eAEjB;UAAA,WACGlB,IAAI,CAAC0C,WAAW;QAAA;UAAA;UAAA;UAAA;QAAA,QAKf;MAAA;QAAA;QAAA;QAAA;MAAA,QACA,eAEN;QAAK,SAAS,EAAC,gBAAgB;QAAA,wBAC7B;UAAA,WAAKnD,MAAM,CAACiD,KAAK,CAACC,WAAW,CAACzC,IAAI,CAAC4B,IAAI,CAACV,QAAQ,EAAE,EAAE,OAAO,CAAC;QAAA;UAAA;UAAA;UAAA;QAAA,QAAU,eAEtE;UAAA,0CACgB;YAAA;YAAA;YAAA;UAAA,QAAM,eACpB;YAAA,UACG,IAAIyB,IAAI,CAACA,IAAI,CAACC,GAAG,EAAE,GAAG,SAAS,CAAC,CAACC,kBAAkB,CAACC,SAAS,EAAE;cAAEC,OAAO,EAAE,MAAM;cAAEC,KAAK,EAAE,MAAM;cAAEC,GAAG,EAAE;YAAU,CAAC;UAAC;YAAA;YAAA;YAAA;UAAA,QAC5G;QAAA;UAAA;UAAA;UAAA;QAAA,QACP,EAEHjD,IAAI,CAACkD,KAAK,GAAG,CAAC,gBACb;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAAgB,gBAEhB;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QACD,eAED;UAAQ,SAAS,EAAC,cAAc;UAAC,OAAO,EAAE5B,UAAW;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAE5C,eAET;UAAA,wBAAG;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA,QAAyB;QAAA;UAAA;UAAA;UAAA;QAAA,QAAU,eACtC;UAAA,wBAAG;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA,QAAsB;QAAA;UAAA;UAAA;UAAA;QAAA,QAAU,EAElCjB,KAAK,iBACJ;UAAK,SAAS,EAAC,iBAAiB;UAAA,2CACf;YAAA;YAAA;YAAA;UAAA,QAAM,eACrB;YAAA,UACG,IAAIsC,IAAI,CAACQ,MAAM,CAAC9C,KAAK,CAAC+C,IAAI,CAAClC,QAAQ,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC2B,kBAAkB,CACjEC,SAAS,EACT;cACEC,OAAO,EAAE,MAAM;cACfM,IAAI,EAAE,SAAS;cACfC,MAAM,EAAE,SAAS;cACjBC,MAAM,EAAE;YACV,CAAC;UAAC;YAAA;YAAA;YAAA;UAAA,QACG;QAAA;UAAA;UAAA;UAAA;QAAA,QAKZ;MAAA;QAAA;QAAA;QAAA;MAAA,QACG,eAGN;QAAQ,OAAO,EAAEnD,SAAU;QAAC,SAAS,EAAC,gBAAgB;QAAA,uBACpD;UAAK,GAAG,EAAEV,KAAM;UAAC,GAAG,EAAC;QAAO;UAAA;UAAA;UAAA;QAAA;MAAG;QAAA;QAAA;QAAA;MAAA,QACxB;IAAA;MAAA;MAAA;MAAA;IAAA;EACL;IAAA;IAAA;IAAA;EAAA,QACD;AAEX,CAAC;AAAA,GA1HKK,OAAO;AAAA,KAAPA,OAAO;AA4Hb,eAAeA,OAAO;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}